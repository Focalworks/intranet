$(document).ready(function () {
    /* handling the addition of pagination class to the ul li generated by L4 Pagination library */
    $('div.pagination').find('ul').addClass('pagination');

    /* handling the delete of entry based on the id from a table list */
    handleDeleteFromTableListing();

    toggleMenuStateForUser();

    // For Comments Tool bar
    toggleCommentToolBar()
});

function handleDeleteFromTableListing()
{
    /**
     * Deleting any items form list
     * multipe items pending
     * @param data-delete-id
     */
    $('.delete-link').click(function(){
        var delId = $(this).attr("data-delete-id");
        var sect = $(this).attr("data-delete-entity");
        var cnfrm = confirm("Sure you want to delete");
        var url = base_url + 'entity/delete';
        if(cnfrm == true) {
            $.ajax({
                type: "POST",
                url: base_url + 'entity/delete',
                data: {id: delId, section: sect}
            }).success(function(data) {
                location.reload();
            });
        } else {
            return false;
        }
    });
}

function toggleMenuStateForUser()
{
    $('.sidebar.menu-wrapper #menuButton').click(function () {
        $.ajax({
            type: "GET",
            url: base_url + 'customise/toggle-menu'
        }).success(function () {
            var sidebar = $('.sidebar.menu-wrapper');
            var currentState = sidebar.data('menu');

            if (currentState == 'normal') {
                sidebar.data('menu', 'active');
                sidebar.removeClass('menu-wrapper-normal');
                sidebar.addClass('menu-wrapper-active');

                var maineWrapper = $('.main-wrapper.main-wrapper-normal');
                maineWrapper.removeClass('main-wrapper-normal');
                maineWrapper.addClass('main-wrapper-active');
            } else {
                sidebar.data('menu', 'normal');
                sidebar.removeClass('menu-wrapper-active');
                sidebar.addClass('menu-wrapper-normal');

                var maineWrapper = $('.main-wrapper.main-wrapper-active');
                maineWrapper.removeClass('main-wrapper-active');
                maineWrapper.addClass('main-wrapper-normal');
            }
        });
    });
}

// Tool bar on Comments

function toggleCommentToolBar() {
  TriggerClick = 0;
  $('body').on('click', '.comments-wrapper .comment-list-item .comment-group .comment-controles-wrapper .comment-controle-icon' , function() {
    $('body').on('click', 'ul.comment-controles li .comment-controle-inner', function(){
      $('.comments-wrapper .comment-list-item .comment-group .comment-controles-wrapper .comment-controle-icon').addClass('comment-controle-icon-normal').removeClass('comment-controle-icon-active');
       $(this).parent().parent('ul.comment-controles').slideUp(500);
    });
    if ($(this).hasClass('comment-controle-icon-active')) {
      TriggerClick = 1;
    } else {
      TriggerClick = 0;
    }
    if(TriggerClick == 0){
      TriggerClick = 1;
      $(this).addClass('comment-controle-icon-active').removeClass('comment-controle-icon-normal');
      $(this).next('ul.comment-controles').slideDown(500);
    } else {
      TriggerClick = 0;
      $(this).addClass('comment-controle-icon-normal').removeClass('comment-controle-icon-active');
      $(this).next('ul.comment-controles').slideUp(500);
    }
  });
}